<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://kit.fontawesome.com/25e30c11ff.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>    <title>Document</title>
</head>
<body>
<nav>
    <div class="nav-wrapper">
    <a href="#!" class="brand-logo"><i class="fas fa-comments-dollar"></i>CryptoChat</a>
      <ul class="right hide-on-med-and-down">
        <li><a href="sass.html"><i class="fas fa-sign-in-alt"></i></a></li>
        <li><a href="badges.html"><i class="fas fa-sign-out-alt"></i></a></li>
      </ul>
    </div>
  </nav>
  <div class ="container">
    <div class="row">
        <div class="collection col l3" id="links">
          </div>
    </div>
  </div>
  </div>
<div class ="col" id="coin">
</div>
<div class ="container" id="meta">
</div>
<footer class="page-footer">
    <div class="container">
      <div class="row">
        <div class="col l6 s12">
          <h5 class="white-text">Footer Content</h5>
          <p class="grey-text text-lighten-4">You can use rows and columns here to organize your footer content.</p>
        </div>
        <div class="col l4 offset-l2 s12">
          <h5 class="white-text">Links</h5>
          <ul>
            <li><a class="grey-text text-lighten-3" href="#!">Link 1</a></li>
            <li><a class="grey-text text-lighten-3" href="#!">Link 2</a></li>
            <li><a class="grey-text text-lighten-3" href="#!">Link 3</a></li>
            <li><a class="grey-text text-lighten-3" href="#!">Link 4</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="footer-copyright">
      <div class="container">
      Â© 2014 Copyright Text
      <a class="grey-text text-lighten-4 right" href="#!">More Links</a>
      </div>
    </div>
</body>
<script>

//https://rapidapi.com/lbraciszewski/api/coinpaprika1?endpoint=apiendpoint_ee7b2ebb-d86c-4468-903d-bd3761321a2b
coinPaprika = "";

//unneeded
//https://www.cryptocompare.com/cryptopian/api-keys
//cryptoCompare = "";

//work on this since both coinpaprika API's are similar 
const dryApi = (x) => {
    const settings = {
	"async": true,
	"crossDomain": true,
	"url": "https://coinpaprika1.p.rapidapi.com/coins" 
  + x,
	"method": "GET",
	"headers": {
		"x-rapidapi-key": coinPaprika,
		"x-rapidapi-host": "coinpaprika1.p.rapidapi.com"
	}
}
return settings;
};

// API to bring back sorted list of coins and coin ID to feed into metadata API
const coinIdExtractor = (i) => {
    const settings = {
	"async": true,
	"crossDomain": true,
	"url": "https://coinpaprika1.p.rapidapi.com/coins",
	"method": "GET",
	"headers": {
		"x-rapidapi-key": "2842162241msh469fff12ef1ec75p14d772jsnd7854fca2435",
		"x-rapidapi-host": "coinpaprika1.p.rapidapi.com"
	}
    }
$.ajax(settings).done(function (res) {
    const coinId = res[i].id;
	console.log(coinId);
    currentCoinMeta(coinId);
    })
};

for (i = 0; i < 1 ; i++) {
    coinIdExtractor(i);
};

// Metadata API for content to display about particular coin
const currentCoinMeta = (coinId) => {
    const coinMeta = {
	"async": true,
	"crossDomain": true,
	"url": "https://coinpaprika1.p.rapidapi.com/coins/" 
  + coinId,
	"method": "GET",
	"headers": {
		"x-rapidapi-key": coinPaprika,
		"x-rapidapi-host": "coinpaprika1.p.rapidapi.com"
    } 
    }
$.ajax(coinMeta).done(function (res) {
    console.log(
        res,
        res.rank,
        res.symbol, 
        res.name, 
        res.description, 
        res.links.facebook, 
        res.links.reddit, 
        res.links.source_code, 
        res.links.youtube, 
        res.links.website );

    var colDiv = $("<div>");
    colDiv.addClass("col");
    $("#meta").append(colDiv);
    var cardDiv = $("<div>");
    cardDiv.addClass("card card-panel hoverable");
    $(colDiv).append(cardDiv);
    var newSpan = $("<span>");
    newSpan.addClass("card-title");
    newSpan.text(res.name);
    cardDiv.append(newSpan);

    //if fb
    var newA = $("<a>");
    newA.addClass("collection-item");
    newA.attr("target","_blank");
    newA.attr("href", res.links.facebook);
    var i = $("<i>");
    i.addClass("fab fa-facebook-f");
    newA.append(i);
    $("#links").append(newA);

    // if reddit
    var newA = $("<a>");
    newA.addClass("collection-item");
    newA.attr("target","_blank");
    newA.attr("href", res.links.reddit);
    var i = $("<i>");
    i.addClass("fab fa-reddit-alien");
    newA.append(i);
    $("#links").append(newA);

    // if github
    var newA = $("<a>");
    newA.addClass("collection-item");
    newA.attr("target","_blank");
    newA.attr("href", res.links.source_code);
    var i = $("<i>");
    i.addClass("fab fa-github");
    newA.append(i);
    $("#links").append(newA);

    //if yutube
    var newA = $("<a>");
    newA.addClass("collection-item");
    newA.attr("target","_blank");
    newA.attr("href", res.links.youtube);
    var i = $("<i>");
    i.addClass("fab fa-youtube");
    newA.append(i);
    $("#links").append(newA);

    //if website
    var newA = $("<a>");
    newA.attr("target","_blank");
    newA.addClass("btn-floating waves-effect waves-light halfway-fab light-green accent-1");
    newA.attr("href", res.links.reddit);
    var i = $("<i>");
    i.addClass("fab fa-reddit-alien");
    newA.append(i);
    newA.prepend(newA);

    var cardContentDiv = $("<div>");
    cardContentDiv.addClass("card-content");
    cardDiv.append(cardContentDiv);
    var newP = $("<p>");
    newP.text(res.description);
    cardContentDiv.append(newP);
    })
};

// return res.symbol to feed into cryptocompareAPI to get %change, price etc.
const resRank = "BTC";
//temp
const test = {
	"async": true,
	"crossDomain": true,
	"url": "https://min-api.cryptocompare.com/data/pricemultifull?fsyms=" +
  resRank +
  "&tsyms=USD",
	"method": "GET"
}
$.ajax(test).done(function (res) {
    console.log(res);
    const imgUrl = res.DISPLAY.BTC.USD.IMAGEURL;
    var colDiv = $("<div>");
    colDiv.addClass("col");
    $("#coin").append(colDiv);
    var cardDiv = $("<div>");
    cardDiv.addClass("card card-panel hoverable");
    $(colDiv).append(cardDiv);
    var newImg = $("<img>");
    newImg.addClass("pic");
    newImg.attr("src", "https://www.cryptocompare.com" + imgUrl);
    cardDiv.append(newImg);
});

</script>
</html>